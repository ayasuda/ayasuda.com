---
title: 'Go 言語における文字列'
date: '2100-12-31'
description: ''
keywords:
  - Golang
  - String
  - Rune
---

なんだかんだで慣れてくると手癖でプログラムを書いてしまうものです。
たまには基礎に振り返って、Go 言語での文字列の取り扱いについて改めてみてみましょう。

この文書では Go 言語の [言語仕様](https://golang.org/ref/spec) から、文字列に関する部分をまとめ、
各種実験コードで動きをみてみましょう。

# ソースコードの文字コード

ソースコードは UTF-8 でエンコードされた Unicode で書かれます。
その他ソースコード中に使える文字についての制限は https://golang.org/ref/spec#Source_code_representation を参照してください。

# 文字と文字列

まずは文字と文字列について見ていきましょう。
Golang では以下の定義済み型が文字・文字列に関連しています。

* byte (uint8 のエイリアス)
* rune (int32 のエイリアス)
* string

string はバイトのシーケンスで、不変なオブジェクトです。

Golang における文字列は
バイトのシーケンスで、文字長はバイト数です。
一度定義されると不変です。
文字長 s は組み込み関数 `len` を使い計算可能で、特に定数の文字長はコンパイル時に計算されます。
文字列の各バイトにはインデックスを使いアクセス可能で、その範囲は 0 から `len(s) - 1` の範囲です。
この時、それぞれの要素のアドレスは取得できません。例えば、`s[i]` はアクセス可能で、文字列の `i`バイト目ですが、`&s[i]` は不正な値となります。


文字リテラル

文字列リテラル



書き出し

見出し１
====





## 文字列リテラル

文字列は二つのフォーマットで定義できます。
一つは生の文字列リテラル (raw string liteeral)、もう一つは翻訳された文字列リテラル (interpreted string literal) です。

生の文字列リテラルはバッククォーテーション (\`) でくくって定義します。
バッククォーテーションの間には、バッククォートを除く全ての文字を入れることができます。
生の文字列リテラルの値は翻訳されていない、UTF-8に暗黙的にエンコードされたクォーテーション間の文字の集合となります。
特に、バックスラッシュは特別な意味を持ちませんし、文字列中に改行を含めることが可能です。
生の文字列リテラルで定義した文字列中からはキャリッジリターン ('\r') は除去されます。

翻訳された文字列リテラルはダブルクォーテーション (\") でくくって定義します。
クォーテーションの間は改行とエスケープされていないダブルクォーテーションを除いた全ての文字を入れることができます。
クォーテーション間の文字列はリテラルの値となり、バックスラッシュでエスケープされた文字は rune リテラルと同じように解釈され、同じ制限を受けます。
3桁の8進数と2桁の10進数はそれぞれ個別のバイトとして解釈されます。全てのエスケープは (可能ならマルチバイトの) UTF-8 にエンコードされた個々の文字として解釈されます。
従って翻訳された文字列リテラル中の `\377` と \xFF` は同じ１バイトの値と解釈され、
また、`\u00FF`, `\U000000FF`、`\xc3\xbf`、` ÿ` は全て UTF-8 にエンコードされた文字`U+00FF` 、つまり 0xc3 0xbf で現される２バイトの文字として解釈されます。

## 文字リテラル

文字リテラルは文字定数を現し、整数値でユニコードのコードポイントを現します。
文字リテラルはシングルクォーテーション (\') で括って定義した1文字以上の文字で定義します。
シングルクォーテーションの間には、改行とエスケープされていないシングルクォーテーションを除いた全て文字を入れることができます。
シングルクォーテーションの間の文字はユニコードで表された文字自体の値を表し、バックスラッシュでエンコードされた複数の文字はフォーマットされたユニコード値です。

Go のソースコード自体は UTF-8 でエンコードされているユニコード文字で書かれるため、文字リテラルの整数値が UTF-8 エンコードされた複数バイトを表す場合があります。
例えば、 `'a'` は 1 バイトの `a` で、ユニコードの U+0061 で、そして `0x61` です。また、`'ä'` は2バイト文字で、ユニコードの U+00E4 で、 `0xe4` です。

バックスラッシュを用いることで任意の値を ASCII テキストとして表現できます。`\` に続く3桁の8進数値や、`\x` に続く2桁の16進数の値、`\u` からは4桁の16進数値、
そして `\U` からは8桁の16進数の値を記すことで、値を直接指定できます。

これらの値は全て正しい範囲にある必要があります。例えば 8 進数で定義するときには 0 から 255 の間にある必要があります。

バックスラッシュを用いた場合、以下の特定の文字と組み合わせることで、特別な値を示すことができます。

\a   U+0007 alert or bell
\b   U+0008 backspace
\f   U+000C form feed
\n   U+000A line feed or newline
\r   U+000D carriage return
\t   U+0009 horizontal tab
\v   U+000b vertical tab
\\   U+005c backslash
\'   U+0027 single quote  (valid escape only within rune literals)
\"   U+0022 double quote  (valid escape only within string literals)


参考

https://blog.golang.org/strings
https://golang.org/ref/spec
  https://golang.org/ref/spec#Source_code_representation
  https://golang.org/ref/spec#String_types
  https://golang.org/ref/spec#Rune_literals
  https://golang.org/ref/spec#String_literals
  https://golang.org/ref/spec#RangeClause
  https://golang.org/ref/spec#Conversions_to_and_from_a_string_type
